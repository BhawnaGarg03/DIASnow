<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[function onLoad(){
	var gdw = GlideDialogWindow.get();
    var orderLine = gdw.getPreference("orderLine");
	var chrs = document.getElementsByName('ord_characteristics');
	var getchr = orderLine + ',' + chrs;
		var ga = new GlideAjax('sn_ind_tmt_orm.TDGShowHideFields');
ga.addParam('sysparm_name', "getCharName");
ga.getXML(getFieldsCallback);
	var answer = response.responseXML.documentElement.getAttribute('answer');
	alert(answer);
	var showField = answer;
}
			

function continueOK() {
    //alert("OK clicked");
    var gdw = GlideDialogWindow.get();
	var orderLine = gdw.getPreference('orderLine');
//	var chrname = gel('chr_name').value;
	var chrs = document.getElementsByName('ord_characteristics');
//	var Ichr = gel('iterated_char').value;
	var val = '';
	for(var i = 0; i < chrs.length; i++) {
val += chrs[i].value;

//	alert(val+"-----");

    var gr = new GlideRecord("sn_ind_tmt_orm_order_characteristic_value");
    gr.addQuery('order_line_item', orderLine);
	gr.addQuery('characteristic', chrs[i].id);
    gr.query();
		console.log(gr.getEncodedQuery());
    while (gr.next()) {
            gr.characteristic_option_value = chrs[i].value;
            gr.update();
		}
     
    } 

    GlideDialogWindow.get().destroy();
}


function continueCancel() {
    //alert("Cancelled");
    GlideDialogWindow.get().destroy();
}
]]></client_script>
        <description/>
        <direct>false</direct>
        <endpoint>sn_ind_tmt_orm_TDG_DIA_ENDPOINT.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
    <style>
        * { box-sizing: border-box; }
        .row { display: flex; margin-left: -5px; margin-right: -5px; }
        .column { flex: 50%; padding: 5px; }
        table { border-collapse: collapse; border-spacing: 0; width: 100%; border: 1px solid #ddd; }
        th,
        td { text-align: left; padding: 16px; }
        .nopadding { padding: 0px; }
        tr:nth-child(even) { background-color: #f2f2f2;}
		
    </style>
	<g:evaluate var="jvar_custord">
		var orderLineItem = RP.getParameterValue('sysparm_order_line_item') + '';
		var odrline = new GlideRecord('sn_ind_tmt_orm_order_line_item');
		odrline.addQuery("sys_id", orderLineItem); 
		odrline.query();
		while(odrline.next()) {
			odrline.getDisplayValue('order');
		}
	</g:evaluate>	
	
    <g:ui_form>
        <table width="100%">
            <tr>
                <td style="width:25%">
                    <g:form_label>Customer Order</g:form_label>
                </td>
                <td style="width:60%">
                   	<input type="number"  value="${jvar_custord}"   name="cust_ord" id="cust_ord"    readonly="readonly" maxlength="40"/>
                </td>
            </tr>
			
			
			<g:evaluate>
				var grOpt = new GlideRecord('sn_prd_pm_specification_characteristic');
				grOpt.addQuery("specification.name", odrline.getDisplayValue('product_specification'));
				grOpt.query();
				var characteristicsList = [];
				while(grOpt.next()) {
					// Fetch input type from  sn_prd_pm_characteristic table
					var grc = new GlideRecord('sn_prd_pm_characteristic');
					grc.addQuery("name", grOpt.getDisplayValue('characteristic'));
					grc.query();
					while (grc.next()) {
						// Fetch metadata for dropdown values. No records if it is not a multiple choice. 
						var grOptn = new GlideRecord('sn_prd_pm_characteristic_option');
						grOptn.addQuery("characteristic.name", grOpt.getDisplayValue('characteristic'));
						grOptn.query();
						var optnlist = ''; 
						if(grOptn.hasNext()) {
						var reqs = [];
							while (grOptn.next()) {
							optnlist = grOptn.getValue('option'); 						
						reqs.push(optnlist); 
							}
						}
						characteristicsList.push({
							'name': grOpt.getDisplayValue('characteristic'),
							'type': grc.input_type,
							'sys_id': grc.sys_id,
							'optnlist': reqs
						});
							}
						}
			
			</g:evaluate>
			
			<j:forEach var="jvar_charItem" items="${characteristicsList}">
				<tr>
					<td style="width:25%">
						<g:form_label>${jvar_charItem.name} -- ${jvar_charItem.type} </g:form_label>
					</td>  
						<j:if test="${jvar_charItem.type == 'single_line_text'}"> 
						<td style="width:60%"> 
							<input type="text" name="ord_characteristics" id="${jvar_charItem.sys_id}" />
						</td>
					</j:if>
					<j:if test="${jvar_charItem.type == 'choice'}"> 
						<td style="width:60%">
							<select name="ord_characteristics" id="${jvar_charItem.sys_id}">
								<option value = ""> ---Select--- </option>
								<j:forEach var="jvar_charItem1" items="${jvar_charItem.optnlist}">
							   <option value="${jvar_charItem1}">${jvar_charItem1}</option>
								</j:forEach>
							 </select>
						</td>
					</j:if>
					<j:if test="${jvar_charItem.type == 'yes_no'}"> 
						<td style="width:60%">
							<select name="ord_characteristics" id="${jvar_charItem.sys_id}">
								<option value = ""> ---Choose--- </option>
								<j:forEach var="jvar_charItem1" items="${jvar_charItem.optnlist}">
								 <option value="${jvar_charItem1}">${jvar_charItem1}</option>
									</j:forEach>
							</select>
						</td>
				
					</j:if>
					
				</tr>

		</j:forEach>
	
            <tr>
                <td>
                    <g:dialog_buttons_ok_cancel ok_id="submitData" ok="return continueOK()" ok_type="button" ok_text="${gs.getMessage('Save')}" ok_style_class="btn btn-primary" cancel_type="button" cancel_id="cancelData" cancel_style_class="btn btn-default" cancel="return continueCancel()" />
                </td>
            </tr>
        </table>
    </g:ui_form>
</j:jelly>]]></html>
        <name>TDG_DIA_ENDPOINT</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>AD11761</sys_created_by>
        <sys_created_on>2022-10-27 19:49:47</sys_created_on>
        <sys_id>3597887d873a9d1094fa0e58cebb3504</sys_id>
        <sys_mod_count>332</sys_mod_count>
        <sys_name>TDG_DIA_ENDPOINT</sys_name>
        <sys_package display_value="Order Management for Telecom, Media &amp; Tech" source="sn_ind_tmt_orm">3c58f5d55b0310102dff5e92dc81c711</sys_package>
        <sys_policy/>
        <sys_scope display_value="Order Management for Telecom, Media &amp; Tech">3c58f5d55b0310102dff5e92dc81c711</sys_scope>
        <sys_update_name>sys_ui_page_3597887d873a9d1094fa0e58cebb3504</sys_update_name>
        <sys_updated_by>AD11761</sys_updated_by>
        <sys_updated_on>2022-11-10 09:26:23</sys_updated_on>
    </sys_ui_page>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="Order Management for Telecom, Media &amp; Tech">3c58f5d55b0310102dff5e92dc81c711</claim_owner_scope>
        <claim_timestamp>184e6fae8680000001</claim_timestamp>
        <metadata_update_name>sys_ui_page_3597887d873a9d1094fa0e58cebb3504</metadata_update_name>
        <previous_claim_app_version>2.0.2</previous_claim_app_version>
        <previous_claim_name>Order Management for Telecom, Media &amp; Tech</previous_claim_name>
        <previous_claim_scope>3c58f5d55b0310102dff5e92dc81c711</previous_claim_scope>
        <sys_created_by>AD25084</sys_created_by>
        <sys_created_on>2022-12-06 10:28:34</sys_created_on>
        <sys_id>00d60ca28727151094fa0e58cebb35b9</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>AD25084</sys_updated_by>
        <sys_updated_on>2022-12-06 10:28:34</sys_updated_on>
    </sys_claim>
</record_update>
