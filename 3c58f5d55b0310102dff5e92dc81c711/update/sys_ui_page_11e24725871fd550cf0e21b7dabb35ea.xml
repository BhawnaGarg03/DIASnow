<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[	var elems = document.getElementsByName("ord_characteristics");
	for (var i = 0; i < elems.length; i++) {
	    showField(elems[i].parentElement.getAttribute("name"), elems[i].id);
	}

	function populateChars() {
	    if (document.getElementById("optnTable")) {
	        document.getElementById("optnTable").remove();
	    }

	    var getCharAjax = new GlideAjax('sn_ind_tmt_orm.TDGShowHideFields');
	    getCharAjax.addParam("sysparm_name", "getCharacteristicsFromSO");
	    getCharAjax.addParam("sysparm_serviceOrder", document.getElementById("serviceOrder").value);
	    getCharAjax.getXMLAnswer(populateCharTable);
	}

	function populateCharTable(answer) {
	    var characteristicsList = JSON.parse(answer);
	    //var table = document.getElementById("charOptnSO");
	    var tableHtml = "<table width='100%' id='optnTable'>";
	    for (var i = 0; i < characteristicsList.length; i++) {
	        
			tableHtml += '<tr>' +
	            '<td style="width:"25%">' +
	            '<label>' + characteristicsList[i].name + '</label></td>';
	        if (characteristicsList[i].type == 'single_line_text') {
	            tableHtml += '<td style="width:60%" name="' + characteristicsList[i].name + '">';
	            tableHtml += '<input type="text" name="ord_characteristics" id="' + characteristicsList[i].sys_id + '" value="' + characteristicsList[i].optvalue + '" />' +
	                '</td>';
	        }

	        if (characteristicsList[i].type == 'choice') {
	            tableHtml += '<td style="width:60%" name="' + characteristicsList[i].name + '">' +
	                '<select name="ord_characteristics" id="' + characteristicsList[i].sys_id + '">' +
	                '<option value = ""> ---Select--- </option>';
	            for (var j = 0; j < characteristicsList[i].optnlist.length; j++) {
	                tableHtml += '<option value="' + characteristicsList[i].optnlist[j].optvalue + '">' + characteristicsList[i].optnlist[j] + '</option>';
	            }
	            tableHtml += '</select>';
	            tableHtml += '</td>';

	        }

	        if (characteristicsList[i].type == 'yes_no') {
	            tableHtml += '<td style="width:60%" name="' + characteristicsList[i].name + '">' +
	                '<select name="ord_characteristics" id="' + characteristicsList[i].sys_id + '">' +
	                '<option value = ""> ---Choose--- </option>';

	            for (var j = 0; j < characteristicsList[i].optnlist.length; j++) {
	                tableHtml += '<option value="' + characteristicsList[i].optnlist[j].optvalue + '">' + characteristicsList[i].optnlist[j] + '</option>';
	            }
	            tableHtml += '</select>';
	        }
	        tableHtml += '</td>' +
	            '</tr>';
	    }
	    tableHtml += "</table>";
	    
		document.getElementById("optnDiv").insertAdjacentHTML("afterend",
	        tableHtml);
	}

	function showField(field, id) {
	    ga = new GlideAjax('sn_ind_tmt_orm.TDGShowHideFields');
	    ga.addParam('sysparm_name', "getCharName");
	    ga.getXML(getFieldsCallback);

	    function getFieldsCallback(response) {
	        var answer = response.responseXML.documentElement.getAttribute('answer');
	        var attributes = JSON.parse(answer.toString());
	        //	g_form.addInfoMessage(attributes);
	        var LableList = [];
	        attributes.forEach(function(list) {

	            if (list.Label == field) {
	                if (list.routingProtocol == "false") {
	                    document.getElementById(id).parentElement.parentElement.style.display = "none";
	                }
	            }
	        });
	    }
	}

	function continueOK() {
	    //alert("OK clicked");
	    var gdw = GlideDialogWindow.get();
	    var orderLine = gdw.getPreference('orderLine');
	    //	var chrname = gel('chr_name').value;
	    var chrs = document.getElementsByName('ord_characteristics');
	    //	var Ichr = gel('iterated_char').value;
	    var chars = [];
	    for (var i = 0; i < chrs.length; i++) {
			var charElem = {};
	        charElem.id = chrs[i].id;
			charElem.val = chrs[i].value;
			chars.push(charElem);
		}
		
		var updateValsGa = new GlideAjax("sn_ind_tmt_orm.TDGShowHideFields");
		updateValsGa.addParam("sysparm_name", "updateCharValues");
		updateValsGa.addParam("sysparm_chars", JSON.stringify(chars));
		updateValsGa.addParam("sysparm_orderLine", orderLine);
		
		updateValsGa.getXMLAnswer(valuesUpdated);
		
		function valuesUpdated(answer) {
			if(answer == "true") 
				GlideDialogWindow.get().destroy();
		}
	}

	function continueCancel() {
	    //alert("Cancelled");
	    GlideDialogWindow.get().destroy();
	}]]></client_script>
        <description/>
        <direct>false</direct>
        <endpoint>sn_ind_tmt_orm_DIA_TDG_Test_EndPoint_BG.do</endpoint>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
    <style>
        * { box-sizing: border-box; }
        .row { display: flex; margin-left: -5px; margin-right: -5px; }
        .column { flex: 50%; padding: 5px; }
        table { border-collapse: collapse; border-spacing: 0; width: 100%; border: 1px solid #ddd; }
        th,
        td { text-align: left; padding: 16px; }
        .nopadding { padding: 0px; }
        tr:nth-child(even) { background-color: #f2f2f2;}
		#sn_ind_tmt_orm_DIA_TDG_Test_EndPoint_BG { height: 100px; overflow: auto;}
		
    </style>
	<g:evaluate var="jvar_custord">
		var orderLineItem = RP.getParameterValue('sysparm_order_line_item') + '';
		var odrline = new GlideRecord('sn_ind_tmt_orm_order_line_item');
		odrline.addQuery("sys_id", orderLineItem); 
		odrline.query();
		while(odrline.next()) {
			odrline.getDisplayValue('order');
		}
	</g:evaluate>	
	
    <g:ui_form>
        <table id="charTable" width="100%">
            <tr>
                <td style="width:25%">
                    <g:form_label>Customer Order</g:form_label>
                </td>
                <td style="width:60%">
                   	<input type="number"  value="${jvar_custord}"   name="cust_ord" id="cust_ord" maxlength="40"/>
                </td>
            </tr>
			<g:evaluate var="jvar_serviceOrders">
				//add short desc
				var serviceOrders = new GlideRecord("sn_ind_tmt_orm_service_order");
				serviceOrders.addEncodedQuery("top_order_line_item=" + odrline.sys_id);
				serviceOrders.query();
				var orders = [];
				while(serviceOrders.next()) {
				var order = {};
					order.num = serviceOrders.number.toString();
				order.value = serviceOrders.sys_id.toString();
				orders.push(order);
				}
				
				orders;
			</g:evaluate>
			<tr>
                <td style="width:25%">
                    <g:form_label>Service Order</g:form_label>
                </td>
                <td style="width:60%">
                   	<select name="serviceOrder" id="serviceOrder" onchange="populateChars()">
								<option value = ""> ---Select--- </option>
								<j:forEach var="jvar_sOrders" items="${orders}">
							   <option value="${jvar_sOrders.value}">${jvar_sOrders.num}</option>
								</j:forEach>
							 </select>
                </td>
            </tr>
		</table>
		<div id="charOptnSO" width="100%">
			<div id="optnDiv"></div>
		</div>
        <table width="100%">   
		<tr>
                <td>
                    <g:dialog_buttons_ok_cancel ok_id="submitData" ok="return continueOK()" ok_type="button" ok_text="${gs.getMessage('Save')}" ok_style_class="btn btn-primary" cancel_type="button" cancel_id="cancelData" cancel_style_class="btn btn-default" cancel="return continueCancel()" />
                </td>
            </tr>
        </table>
    </g:ui_form>
</j:jelly>]]></html>
        <name>DIA_TDG_Test_EndPoint_BG</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>AD25084</sys_created_by>
        <sys_created_on>2022-11-21 11:20:41</sys_created_on>
        <sys_id>11e24725871fd550cf0e21b7dabb35ea</sys_id>
        <sys_mod_count>30</sys_mod_count>
        <sys_name>DIA_TDG_Test_EndPoint_BG</sys_name>
        <sys_package display_value="Order Management for Telecom, Media &amp; Tech" source="sn_ind_tmt_orm">3c58f5d55b0310102dff5e92dc81c711</sys_package>
        <sys_policy/>
        <sys_scope display_value="Order Management for Telecom, Media &amp; Tech">3c58f5d55b0310102dff5e92dc81c711</sys_scope>
        <sys_update_name>sys_ui_page_11e24725871fd550cf0e21b7dabb35ea</sys_update_name>
        <sys_updated_by>AD25084</sys_updated_by>
        <sys_updated_on>2022-11-22 09:08:12</sys_updated_on>
    </sys_ui_page>
    <sys_claim action="INSERT_OR_UPDATE">
        <claim_owner_scope display_value="Order Management for Telecom, Media &amp; Tech">3c58f5d55b0310102dff5e92dc81c711</claim_owner_scope>
        <claim_timestamp>184e6fae9e20000001</claim_timestamp>
        <metadata_update_name>sys_ui_page_11e24725871fd550cf0e21b7dabb35ea</metadata_update_name>
        <previous_claim_app_version>2.0.2</previous_claim_app_version>
        <previous_claim_name>Order Management for Telecom, Media &amp; Tech</previous_claim_name>
        <previous_claim_scope>3c58f5d55b0310102dff5e92dc81c711</previous_claim_scope>
        <sys_created_by>AD25084</sys_created_by>
        <sys_created_on>2022-12-06 10:28:34</sys_created_on>
        <sys_id>40d60ca28727151094fa0e58cebb35db</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>AD25084</sys_updated_by>
        <sys_updated_on>2022-12-06 10:28:34</sys_updated_on>
    </sys_claim>
</record_update>
